<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Результаты конкурса (Метод Борда с отсечением)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        th, td {
            padding: 8px 12px;
            text-align: left;
            border: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #f0f0f0;
        }
        .top-3 {
            font-weight: bold;
            background-color: #fffde7;
        }
        /* Стили для топ-3 мест */
        tr.top-3[data-rank="1"] {
            background-color: #ffd700 !important; /* Золото */
        }
        tr.top-3[data-rank="2"] {
            background-color: #c0c0c0 !important; /* Серебро */
        }
        tr.top-3[data-rank="3"] {
            background-color: #cd7f32 !important; /* Бронза */
        }
        /* Удаляем устаревшие стили по nth-child, т.к. на одной позиции может быть несколько участников */
        tr:nth-child(2), tr:nth-child(3), tr:nth-child(4) {
            background-color: inherit;
        }
        .loader {
            text-align: center;
            margin: 50px 0;
        }
        .error {
            color: red;
            padding: 20px;
            border: 1px solid red;
            background-color: #ffeeee;
            margin: 20px 0;
        }
        .file-upload {
            margin: 20px 0;
            padding: 20px;
            border: 2px dashed #ddd;
            text-align: center;
            border-radius: 5px;
        }
        .file-upload:hover {
            border-color: #aaa;
        }
        .file-upload-message {
            font-size: 18px;
            margin-bottom: 15px;
        }
        .btn {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        .btn:hover {
            background-color: #45a049;
        }
        .results-container {
            display: none;
        }
        .options {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .settings-panel {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .settings-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .settings-row label {
            flex: 1;
            margin-right: 10px;
        }
        .settings-row input {
            flex: 2;
        }
        .settings-row .value-display {
            flex: 0 0 50px;
            text-align: center;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
        
        /* Стили для таблиц с рейтингами судей */
        .judges-rankings table {
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        /* Убираем наследование стилей таблицы результатов для таблиц судей */
        .judge-table tr:nth-child(2),
        .judge-table tr:nth-child(3),
        .judge-table tr:nth-child(4) {
            background-color: inherit; /* Сбрасываем золото, серебро и бронзу */
        }
        
        /* Убираем наследование стилей таблицы результатов для таблицы информации о CSV */
        .csv-info-table tr:nth-child(2),
        .csv-info-table tr:nth-child(3),
        .csv-info-table tr:nth-child(4) {
            background-color: inherit !important; /* Сбрасываем золото, серебро и бронзу */
        }
        
        /* Стандартное оформление для строк таблицы CSV-инфо */
        .csv-info-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        /* Стили для первых трех мест в таблицах судей */
        .judge-top-3 {
            font-weight: bold;
        }
        .judge-top-3[data-rank="1"] {
            background-color: #ffd700 !important; /* Золото */
        }
        .judge-top-3[data-rank="2"] {
            background-color: #c0c0c0 !important; /* Серебро */
        }
        .judge-top-3[data-rank="3"] {
            background-color: #cd7f32 !important; /* Бронза */
        }
        
        .judge-ranking h3 {
            margin-top: 25px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
        }
        
        .judge-ranking .judge-top-3 td:first-child {
            font-weight: bold;
        }
        
        /* Стили для модального окна графика */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 900px;
            border-radius: 5px;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover,
        .close:focus {
            color: #000;
        }
        
        .chart-btn {
            padding: 5px 10px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .chart-btn:hover {
            background-color: #0b7dda;
        }
        
        #chartCanvas {
            border: 1px solid #ddd;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Результаты конкурса (Метод Борда с отсечением)</h1>
    
    <div class="options">
        <button class="btn" id="useFileUpload">Загрузить свой файл</button>
        <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
    </div>
    
    <div id="results" class="results-container">
        <div class="settings-panel">
            <h3>Настройки расчета</h3>
            <div class="m-description" style="margin: 10px 0; padding: 10px; background-color: #f5f5f5; border-radius: 5px; font-size: 0.9em; color: #333;">
                Параметр M определяет, сколько верхних оценок от каждого судьи учитывается при расчете. 
                Чем меньше M, тем меньше участников получают баллы Борда от каждого судьи, и тем строже фильтрация. 
                Система автоматически предлагает оптимальное значение M, чтобы в итоговой таблице было примерно 10 участников с ненулевыми баллами.
            </div>
            <div class="settings-row">
                <label for="topMSlider">Топ-отсечение (M): Учитывать только лучшие M оценок от каждого судьи</label>
                <input type="range" id="topMSlider" min="1" max="100" value="15" step="1">
                <div class="value-display" id="topMValue">15</div>
            </div>
            
            <div id="judge-select-container" style="display: none;">
                <label for="judge-select">Исключить оценки судьи:</label>
                <select id="judge-select">
                    <option value="">Не исключать судью</option>
                </select>
            </div>
            
            <div id="results-all-judges" class="results-section">
                <h2>Результаты с учетом всех судей</h2>
                <div id="results-all-container"></div>
            </div>
            
            <div id="results-without-judges" class="results-section">
                <h2>Результаты с исключением каждого из судей</h2>
                <div id="judge-excluded-results"></div>
            </div>
            
            <div id="results-by-judge" class="results-section">
                <h2>Рейтинги от каждого судьи</h2>
                <div id="judges-rankings"></div>
            </div>
        </div>
    </div>
    
    <!-- Контейнер для отображения ошибок -->
    <div id="error-container" class="error" style="display: none;"></div>
    
    <!-- Модальное окно для графика -->
    <div id="chartModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle">График места участника</h2>
            <canvas id="chartCanvas" width="900" height="550"></canvas>
        </div>
    </div>
    
    <!-- Встроенные данные CSV (скрытые) -->
    <script id="embeddedCsvData" type="text/plain">
        Порядковый номер участника,Никней-м,Алексей Кузнецов,"Марина
 Волкова",Дмитрий Соколов,Ирина Морозова,Елена Новикова,Сергей Васильев,Николай Иванов
1,"Виктор Цой
Кино
Группа крови
","4,2",4,"4,4","4,2","4,9","4,4","3,5"
2,"Земфира Рамазанова
Zемфира
Искала
","3,7","3,2","3,6","2,5","4,3","3,6","2,5"
3,"Юрий Шевчук
ДДТ
Что такое осень
","3,9","3,8","4,6","4,3","4,5","4,3","3,6"
4,"Илья Лагутенко
Мумий Тролль
Владивосток 2000
","3,8","3,3","4,4","4,4","4,7","4,6","3,3"
5,"Александр Васильев
Сплин
Выхода нет
","3,5","3,4","3,6","3,3","4,5","3,7","2,6"
6,"Владимир Шахрин
Чайф
Оранжевое настроение
","4,2","4,6","4,9","4,2","4,6","4,5","4,3"
7,"Диана Арбенина
Ночные Снайперы
31-я весна
",4,4,,2,"4,1","3,5","3,3"
8,"Вячеслав Бутусов
Nautilus Pompilius
Прогулки по воде
","4,1","4,1",4,"3,5","4,4","4,5","3,4"
9,"Егор Летов
Гражданская оборона
Всё идёт по плану
","4,2","3,9",4,"3,8","4,3","4,3","3,6"
10,"Борис Гребенщиков
Аквариум
Город золотой
",4,"3,7","4,4","3,8","4,9","4,6","3,5"
11,"Константин Кинчев
Алиса
Небо славян
","4,3","3,9",5,"4,6","4,7","4,8","4,1"
12,"Сергей Шнуров
Ленинград
Экспонат
","4,2","3,5","3,4","3,3","4,1","3,8","3,4"
13,"Андрей Макаревич
Машина времени
Поворот
","4,7",,"4,9",2,"4,8","4,5","2,9"
14,"Гарик Сукачёв
Неприкасаемые
Моя бабушка курит трубку
","3,8","3,6",3,"3,6","4,3","3,7","3,0"
16,"Валерий Кипелов
Ария
Я свободен
","4,2","3,6","4,4","3,9","4,3","3,9","4,0"
17,"Михаил Горшенёв
Король и Шут
Лесник
",4,"4,4","4,4","3,5","4,9","4,6","3,8"
18,"Сергей Бабкин
5'nizza
Солдат
","3,9","3,8","3,2","3,3","4,5","3,7","2,6"
19,"Андрей Лысиков
Дельфин
Весна
","4,5","4,5",,2,"4,7","4,3","2,8"
20,"Евгений Фёдоров
Tequilajazzz
Зимнее солнце
","3,9",4,,"3,6",4,"4,2","3,8"
21,"Максим Покровский
Ногу свело!
Хару Мамбуру
","4,4","4,3","4,4","4,8","4,5",4,"4,6"
22,"Иван Алексеев
Noize MC
Выдыхай
","4,3","4,4","4,6","4,2",5,"4,1","3,5"
23,"Василий Гончаров
Вася Обломов
Еду в Магадан
","4,5","4,6","4,8","3,6","4,8","4,2","3,6"
24,"Владислав Паршин
Motorama
Alps
",4,"3,5","4,6","3,7","4,7","4,1","3,5"
25,"Женя Любич
Jenya Lyubich
Russian Girl
",4,"3,6",4,"3,6","4,4","4,7","3,5"
27,"Юрий Каплан
Валентин Стрыкало
Наше лето
",3,"3,1","3,2",2,4,"3,6","3,1"
28,"Антон Беляев
Therr Maitz
Undercover
",4,"3,8","4,4",4,"4,4","3,9","3,6"
29,"Николай Комягин
Shortparis
Страшно
","4,3",4,"4,7","3,7","4,7","4,6","3,6"
30,"Павел Додонов
Pavel Dodonov
The Catcher in the Rye
",4,"4,3","4,9","3,6","4,7","4,7","3,5"
31,"Евгений Алёхин
Макулатура
Парашют
","4,3","3,6","4,8","3,6","4,6","3,8","4,4"
32,"Олег Нестеров
Мегаполис
Супертанго
","3,5","3,5","4,4",2,"4,4","3,8","3,1"
33,"Александр Ситников
4 Позиции Бруно
Товарищ
","4,2","3,6","4,6","3,5","4,6","4,1","3,9"
34,"Ричард Семашков
 Ploho
Танцы в темноте
","3,9","4,1","4,7","3,7","4,5","4,1","3,5"
35,"Алина Орлова
Alina Orlova
Lovesong
","4,3","3,8","4,2","4,3",,"4,2","3,3"
36,"Кирилл Иванов
СБПЧ
У нас есть всё
",4,"4,2","4,9","3,7","4,6","3,8","3,3"
37,"Анна Пингина
Anna Pingina
Ласточка
","4,2","4,3","4,9","3,6","4,4",4,"3,4"
38,"Инна Желанная
Inna Zhelannaya
Татары
","3,8","3,8",4,"3,3","4,9","3,9","3,4"
39,"Сергей Старостин
Sergey Starostin
Хождение по водам
","3,9","3,3",4,"3,5","4,5","4,1","3,4"
40,"Радик Тюлюш
Хуун-Хуур-Ту
Чингис-Хаан
",4,"3,3","4,8",3,"4,6","4,1","3,4"
41,"Альберт Кувезин
Ят-Ха
Тува
",4,"3,7","4,9","3,8",5,"4,6","4,1"
42,"Пелагея Ханова
Пелагея
Ой, то не вечер
","4,2","3,5",4,"3,6","4,4","4,1","4,0"
43,"Людмила Зыкина
Lyudmila Zykina
Течёт река Волга
","4,5",4,"4,7","3,4","4,4","4,6","3,3"
44,"Муслим Магомаев
Muslim Magomayev
Синяя вечность
",4,4,"4,7",3,"4,6","4,2","4,1"
45,"Эдуард Хиль
Eduard Khil
Трололо
","4,4","4,4",5,"3,9","4,7","4,3","3,9"
46,"Иосиф Кобзон
Iosif Kobzon
Мгновения
","4,1",4,5,"4,3","4,8","4,3","4,6"
47,"Алла Пугачёва
Alla Pugacheva
Миллион алых роз
","3,8",3,,3,"4,1","3,5","3,0"
48,"Филипп Киркоров
Philipp Kirkorov
Цвет настроения синий
","4,2","3,2","4,2",2,"4,5","4,5","3,5"
49,"Николай Басков
Nikolay Baskov
Шарманка
","4,2","3,8","4,8",3,"4,6","4,1","3,5"
50,"Валерий Леонтьев
Valery Leontiev
Дельтаплан
","3,9","3,9","4,2",4,"4,7","4,7","3,8"
51,"София Ротару
Sofia Rotaru
Лаванда
","4,5",4,"4,2","4,2",,"4,2","4,6"
52,"Лев Лещенко
Lev Leshchenko
День Победы
","4,3",4,"4,6","3,8","4,6","4,3","3,8"
53,"Эдита Пьеха
Edita Piekha
Город детства
",,"3,9",,3,,,"3,0"
54,"Валерий Меладзе
Valeriy Meladze
Сэра
","4,6","4,4","4,4","3,5","4,9","4,4","4,3"
55,"Григорий Лепс
Grigory Leps
Рюмка водки на столе
","4,2",4,,4,"4,5","4,2","3,4"
56,"Дима Билан
Dima Bilan
Невозможное возможно
",,4,"4,7","3,7",,,"3,8"
57,"Сергей Лазарев
Sergey Lazarev
В самое сердце
","4,3","3,6","4,8","3,6","4,8","4,3","3,4"
58,"Полина Гагарина
Polina Gagarina
Кукушка
","4,3","3,9","3,8","3,2","4,6","4,2","3,4"
59,"Елена Темникова
Serebro
Мама Люба
","4,3",4,"4,6",2,"4,7","4,3","4,1"
60,"Нюша Шурочкина
Нюша
Выбирать чудо
","4,4",4,"4,8","4,2","4,7","4,6","4,1"
61,"Вера Брежнева
ВИА Гра
Попытка №5
","4,1",4,"4,7","3,6","4,7","4,4","4,1"
62,"Ёлка
Yolka
Прованс
","4,2","4,2","3,8","3,9","4,6","4,1","3,4"
63,"Алексей Воробьёв
Alex Sparrow
Сумасшедшая
","4,2","4,1",,"3,6","4,5","4,4","3,5"
64,"Тимати
Timati
Баклажан
","4,5","3,7","4,9","4,2","4,7","4,7","4,4"
65,"Баста
Basta
Моя игра
","4,5",4,"4,2","3,7","4,3","4,4","3,5"
66,"Гуф
Guf
Ice Baby
","4,1","3,6","4,6","3,3","4,4","4,2","3,4"
67,"Оксимирон
Oxxxymiron
Город под подошвой
",4,"3,7","3,8","3,5","4,4",4,"3,6"
68,"Скриптонит
Scriptonite
Ламбада
","4,1","4,1","4,2","3,3","4,5","4,1","3,4"
69,"Макс Корж
Max Korzh
Малый повзрослел
","4,3","4,2","4,9","2,5","4,6","4,2","3,1"
70,"Элджей
Allj
Розовое вино
","4,3","3,8","4,2","3,6","4,5","4,1","3,7"
71,"Моргенштерн
Morgenshtern
Cadillac
","4,5",4,"4,2",,"4,7","4,3","4,4"
72,"Фараон
Pharaoh
Дико, например
","4,2","3,5",3,"4,1","4,6","3,8","4,0"
73,"ЛСП
LSP
Монетка
","4,3","3,7",4,"3,8","4,5","3,9","4,4"
74,"Хаски
Husky
Панелька
","4,1","3,7",4,"3,6","4,4",4,"3,6"
75,"Монеточка
Monetochka
Каждый раз
",,"4,2","3,8","3,7","4,3","3,8","3,6"
76,"Гречка
Grechka
Люби меня, люби
",4,"3,9","4,4",3,"4,4","3,8","3,8"
77,"Иван Дорн
Ivan Dorn
Стыцамен
","4,3","3,8","4,4","4,3","4,6","4,4","4,0"
78,"Антоха MC
Antokha MC
Время Ток
","4,4","3,7",3,"3,6","4,7","4,2","3,4"
79,"Мальбэк
Malbec
Гипнозы
","4,4","4,5",4,3,"4,3","3,8","3,0"
80,"Cream Soda
Cream Soda
Никаких больше вечеринок
","4,6","3,9","4,4","3,8","4,3","4,1","3,4"
81,"ATL
ATL
Танцевать
","4,2",4,"4,4","3,7","4,3","3,9","3,4"
82,"Boulevard Depo
Boulevard Depo
Angry Toys","4,1","3,4","4,6","3,5","4,4","3,8","3,8"
83,"Big Baby Tape
Big Baby Tape
Gimme the Loot","3,8","3,3","4,8","2,5","4,5","4,3","4,1"
84,"Face
Face
Юморист
",,"4,4","4,7","3,5","4,9","4,6","4,1"
85,"GONE.Fludd
GONE.Fludd
Мамбл","4,5","3,9",4,4,"4,6","4,1","3,2"
86,"Markul
Markul
Fata Morgana","3,8","3,3","4,2","3,5","4,6","3,9","3,3"
87,"Feduk
Feduk
Розовое вино",4,4,4,"3,7","4,9","4,3","4,2"
88,"T-Fest
T-Fest
Ламбада",4,"3,8","4,2",3,"4,5","3,7","4,1"
89,"Егор Крид,JONY,Elman","4,3","3,9","4,2","3,3","4,7",4,"3,9"
90,"HammAli & Navai
HammAli & Navai
Прятки","4,4","4,2",3,4,"4,6","4,3","3,4"
91,"Rauf & Faik
Rauf & Faik
Детство","4,5","4,3","3,5","3,5","4,8",,"4,2"
92,"Artik & Asti
Artik & Asti
Грустный дэнс","4,5","3,8",4,"3,3","4,7","4,2","3,5"     
</script>
    <script src="script.js"></script>
</body>
</html> 